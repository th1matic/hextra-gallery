# 修改日志

## 2025-09-15 - 实现画廊主页功能

### 新增文件
1. **layouts/gallery-home.html** - 画廊主页布局文件
   - 基于 hextra-home.html 创建专门的画廊布局
   - 集成图片索引和随机展示功能
   - 包含刷新按钮和加载指示器
   - 使用 easy-image-cards 组件展示图片

### 修改文件
1. **exampleSite/content/_index.md** - 主页内容文件
   - 将布局从 `hextra-home` 更改为 `gallery-home`
   - 更新标题为"图片画廊"
   - 添加画廊相关的描述内容

### 实现功能
1. **图片索引功能**
   - 使用 Hugo 的 `readDir` 函数自动扫描 `exampleSite/static/images` 目录
   - 支持常见图片格式：jpg, jpeg, png, webp, gif
   - 动态生成图片路径数组

2. **随机图片展示功能**
   - JavaScript 实现数组随机打乱算法
   - 每次加载随机选择最多20张图片
   - 如果图片总数少于20张，则显示所有图片

3. **刷新按钮功能**
   - 提供用户界面按钮，带有刷新图标
   - 点击按钮重新随机选择图片
   - 包含加载动画效果

4. **easy-image-cards 组件集成**
   - 使用现有的 easy-image-cards 容器和样式
   - 保持原有的图片复制功能
   - 支持悬停效果和复制指示器
   - 使用中等尺寸模式 (120-200px)

5. **用户体验优化**
   - 添加加载指示器，显示图片加载状态
   - 使用平滑的过渡动画
   - 响应式设计，适配不同屏幕尺寸
   - 支持深色模式

### 技术实现细节
- 使用 Hugo 模板函数进行服务器端图片索引
- JavaScript 客户端实现随机选择和界面交互
- 保持与现有主题样式的一致性
- 复用现有的图片复制功能和样式

### 用户使用说明
1. 访问主页即可看到随机展示的20张图片
2. 点击"随机语录"按钮获取新的随机图片组合
3. 点击任意图片可复制到剪贴板
4. 支持鼠标悬停查看复制提示

### 兼容性
- 完全兼容现有的 Hextra 主题架构
- 保持原有的 easy-image-cards 组件功能
- 支持多语言和深色模式
- 响应式设计支持移动端访问

### 修复记录
- **2025-09-15 修复路径错误**: 将 `readDir "exampleSite/static/images"` 修改为 `readDir "static/images"`，解决 Hugo 在 exampleSite 目录运行时的路径问题
- **2025-09-15 简化导航菜单**: 移除原有的复杂菜单项（Documentation、Blog、About等），只保留搜索和主题切换功能，更适合画廊网站
- **2025-09-15 优化网站配置**: 
  - 将网站标题改为"图片画廊"
  - 禁用Logo显示
  - 移除顶部横幅通知
  - 清空侧边栏菜单
- **2025-09-15 增强搜索功能**: 
  - 在主页内容中添加隐藏的图片索引列表，供FlexSearch索引
  - 在画廊页面添加专门的图片搜索框
  - 实现实时搜索功能，支持文件名模糊匹配
  - 添加搜索结果高亮显示
  - 添加"显示全部"按钮功能
  - 支持ESC键清除搜索
  - 搜索时在图片底部显示文件名
- **2025-09-15 优化图片显示尺寸**: 
  - 创建新的超小尺寸样式 `hextra-easy-image-cards-xsmall`
  - 桌面端每行显示5张图片
  - 添加响应式设计：平板端4张/行，手机端3张/行，小屏幕2张/行
  - 优化图片间距和最小宽度设置
- **2025-09-15 修复CSS语法错误**: 
  - 修正Tailwind CSS v4的语法问题
  - 将`!important`从@apply中移除，使用标准CSS语法
  - 重新构建CSS文件以应用更改
- **2025-09-15 优化流量控制**: 
  - 移除"显示全部"按钮和相关功能，节约服务器流量
  - 将随机图片数量从20张增加到40张
  - 简化界面，只保留刷新功能
  - 更新页面描述文字以反映新的图片数量
- **2025-09-15 更换图片源目录**: 
  - 将图片源从`static/images`更改为`static/quotes-images`
  - 添加`fileExists`检查确保目录存在
  - 添加警告信息用于调试路径问题
  - 优化错误处理，当目录不存在时显示友好提示
  - 更新所有相关的图片路径引用
- **2025-09-15 页面美化优化**: 
  - 去除页眉的文档搜索框，简化导航栏
  - 移除多语言支持，只保留简体中文
  - 去除页脚的语言选择功能
  - 将网站标题从"图片画廊"改为"莎莎语录"
  - 设置网站Logo使用"网站图片.jpg"，尺寸40x40像素
  - 页眉标题文字自动更新为"莎莎语录"
  - 主页标题和描述相应更新
- **2025-09-15 修复首页路由问题**: 
  - 发现并修复了Hugo多语言路由问题
  - 更新`_index.zh-cn.md`文件使用正确的`gallery-home`布局
  - 确保简体中文为默认语言时正确显示画廊主页
  - 替换旧的Hextra主题演示内容为莎莎语录画廊内容
- **2025-09-15 修复Toast通知功能**: 
  - 在画廊页面中添加完整的Toast CSS样式
  - 初始化Toast容器确保功能正常
  - 提供copyImageToClipboard函数的fallback实现
  - 添加showToastOnCard和getToastIcon函数
  - 实现卡片级别的Toast效果，在图片上居中显示
  - 支持成功、错误、警告、信息四种Toast类型
  - 添加响应式设计支持移动端显示
- **2025-09-15 修复图片悬停效果**: 
  - 修复鼠标悬停时图片变黑的问题
  - 添加pointer-events-none到悬停指示器避免事件冲突
  - 优化悬停效果CSS，添加卡片缩放和阴影效果
  - 改进图片悬停时的缩放动画
  - 使用backdrop-filter添加模糊背景效果
  - 移除冲突的内联样式，统一使用CSS类
- **2025-09-15 优化Toast提示时间**: 
  - 将Toast提示时间从3秒改为1秒，提升用户体验
  - 修复提示结束后的状态恢复问题
  - 确保Toast结束后悬停指示器自动隐藏
  - 统一所有Toast（成功、错误、信息）的显示时间
  - 在easy-image-copy.js和画廊页面中同步应用更改
- **2025-09-15 修改页面描述显示语录总数**: 
  - 将"随机展示40张精选图片，点击图片可复制到剪贴板"改为"当前语录量：xx"
  - 使用Hugo模板语法动态统计quotes-images目录中的图片文件总数
  - 支持jpg、jpeg、png、webp、gif格式的图片统计
  - 实现实时同步显示，文件数量变化时自动更新